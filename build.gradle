plugins {
    id('maven-publish')
}

subprojects {
    afterEvaluate {
        if (it.plugins.hasPlugin('maven-publish')) {
            publishing {
                repositories {
                    maven {
                        name = "GitHubPackages"
                        url = uri("https://maven.pkg.github.com/cronometersoftware/openai-java")
                        credentials {
                            username = System.getenv("GITHUB_ACTOR")
                            password = System.getenv("GITHUB_TOKEN")
                        }
                    }
                }
                publications {
                    "$project.name"(MavenPublication) {
                        afterEvaluate {
                            groupId GROUP
                            artifactId property("POM_ARTIFACT_ID");
                            version VERSION_NAME
                            from components.java
                        }
                    }
                }
            }
        }
    }
}
